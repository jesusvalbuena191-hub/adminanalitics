{% extends "layout.html" %}
{% block title %}Informes{% endblock %}
{% block content %}

<div class="container mt-4">
  <h2 class="mb-3">ðŸ“Š Informes</h2>
  <p>En esta secciÃ³n podrÃ¡s consultar y descargar los reportes generados del sistema.</p>

  <!-- Reporte General -->
  <div class="card mt-3">
    <div class="card-body">
      <h5 class="card-title">Reporte General</h5>
      <p class="card-text">Consulta el informe consolidado de usuarios, roles y permisos.</p>
    <a href="/api/reportes/informe_general" class="btn btn-primary">Ver Informe</a>
    <button id="exportarBtn" class="btn btn-success">Exportar Informe</button>

<script>
document.getElementById("exportarBtn").addEventListener("click", function() {
    fetch("/api/informes/exportar")
        .then(response => {
            if (!response.ok) throw new Error("Error al exportar informe");
            return response.blob();
        })
        .then(blob => {
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement("a");
            a.href = url;
            a.download = "informe.xlsx";
            document.body.appendChild(a);
            a.click();
            a.remove();
        })
        .catch(error => alert(error));
});
</script>



    </div>
  </div>

  <!-- Reporte de Tickets Abiertos -->
  <div class="card mt-3">
    <div class="card-body">
      <h5 class="card-title">Tickets Abiertos</h5>
      <p class="card-text">Revisa todos los tickets que aÃºn se encuentran abiertos.</p>
         <a href="/api/reportes/informe_general" class="btn btn-primary">Ver Informe</a>
    <button id="exportarBtn" class="btn btn-success">Exportar Informe</button>
    </div>
  </div>

  <!-- Reporte de Tickets Cerrados -->
  <div class="card mt-3">
    <div class="card-body">
      <h5 class="card-title">Tickets Cerrados</h5>
      <p class="card-text">Consulta el listado de tickets que ya han sido cerrados.</p>
          <a href="/api/reportes/informe_general" class="btn btn-primary">Ver Informe</a>
    <button id="exportarBtn" class="btn btn-success">Exportar Informe</button>
    </div>
  </div>

  <!-- Reporte de Tickets por Departamento -->
  <div class="card mt-3 mb-4">
    <div class="card-body">
      <h5 class="card-title">Tickets por Departamento</h5>
      <p class="card-text">Visualiza el estado de los tickets agrupados por departamento.</p>
          <a href="/api/reportes/informe_general" class="btn btn-primary">Ver Informe</a>
    <button id="exportarBtn" class="btn btn-success">Exportar Informe</button>
    </div>
  </div>

</div>

{% endblock %}
